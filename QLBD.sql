--DOIBONG ( MaDoi, TenDoi) /
--CAUTHU ( MaCT, TenCT, NgaySinh, QuocTich, GhiChu) /
--TRANDAU ( MaTD, MaDoi1, MaDoi2, NgayGiao, MaSan, MaVong) /
--SAN ( MaSan, TenSan, DiaChi, SucChua) /
--CHITIETTRANDAU ( MaChiTiet, MaBt, MaTD) /
--BANTHANG ( MaBT, MaCT, MaDoi, ThoiGian) /
--KETQUA ( MaKQ, MaTD, BTDoi1, BTDoi2, ThoiLuong) /
--VONGDAU ( MaVong, TenVong, MaMua) /
--MUAGIAI ( MaMua, TenMua, TGBatDau, TGKetThuc) /
--DOIBONG_CAUTHU ( MaMua, MaDoi, MaCT, SoLuongBT) /
--DOIBONG_MUAGIAI ( MaMua, MaDoi, NaSanNha) /
--QUYDINHCAUTHU ( MaQD, TuoiToiThieu, TuoiToiDa, SoCTToiThieu, SoCTToiDa, SoCTNuocNgoaiToiDa) /
--QUYDINHBANTHANG (MaQD, ThoiDiemGhiBanToiDa, Thang, Hoa, Thua) /
--BANGXEPHANG (MaXH, MATD, MaDoi, TenDoi, Thang, Hoa, Thua, HieuSo, Hang) /
--DANHSACHGHIBAN ( MaGB, MaCT, TenCT, MaDoi, TenDoi, LoaiCT, SoBanThang) /
--NHATAITRO (MaNTT, TenNTT, HinhThucTaiTro, MaMua)
--THEPHAT( MaTP, TenTP, MaTT, MaCT, MaDoi)
--NHANVIEN ( MaNV, TenNV, NGSinh, TenTK, MatKhau)
--BOPHAN ( MaBP, TenBP)
--CHUCVU (MaCV, TenCV, MaBP)
--NHANVIEN_CHUCVU (MaNV, MaCV)
--TRONGTAI ( MaTT, TenTT)
--GIAMSATVIEN( MaGSV, TenGSV)


CREATE DATABASE QLBD

CREATE TABLE DOIBONG(
	MADOI INT PRIMARY KEY,
	TENDOI NVARCHAR(50),
);

CREATE TABLE CAUTHU(
	MACT INT PRIMARY KEY,
	TENCT NVARCHAR(50), 
	NGAYSINH SMALLDATETIME,
	QUOCTICH NVARCHAR(50),
	GHICHU NVARCHAR(50),
);

CREATE TABLE TRANDAU(
	MATD INT PRIMARY KEY,
	MADOI1 INT, 
	MADOI2 INT,
	NGAYGIO SMALLDATETIME,
	MASAN INT,
	MAVONG INT,
);

CREATE TABLE SAN(
	MASAN INT PRIMARY KEY,
	TENSAN NVARCHAR(50),
	DIACHI NVARCHAR(50),
	SUCCHUA INT,
);

CREATE TABLE CTTRANDAU(
	MACT INT PRIMARY KEY,
	MABT INT,
	MATD INT,
);

CREATE TABLE BANTHANG(
	MABT INT PRIMARY KEY,
	MACT INT,
	MADOI INT,
	THOIGIAN INT,
);

CREATE TABLE KETQUA(
	MAKQ INT PRIMARY KEY,
	MATD INT,
	BTDOI1 INT,
	BTDOI2 INT,
);

CREATE TABLE VONGDAU(
	MAVONG INT PRIMARY KEY,
	TENVONG NVARCHAR(50),
	MAMUA INT,
);

CREATE TABLE MUAGIAI(
	MAMUA INT PRIMARY KEY,
	TENMUA NVARCHAR(50),
	TGBATDAU SMALLDATETIME,
	TGKETTHUC SMALLDATETIME,
);

CREATE TABLE DOIBONG_CAUTHU(
	MAMUA INT PRIMARY KEY,
	MADOI INT,
	MACT INT,
	SOLUONGBT INT,
);

CREATE TABLE DOIBONG_MUAGIAI(
	MAMUA INT PRIMARY KEY,
	MADOI INT,
	MASANNHA INT,
);

CREATE TABLE QUYDINHBANTHANG(
	MAQD INT PRIMARY KEY,
	TDGHIBANTOIDA INT,
	THANG INT,
	HOA INT, 
	THUA INT,
);

CREATE TABLE QUYDINHCAUTHU(
	MAQD INT PRIMARY KEY,
	TUOITOITHIEU INT,
	TUOITOIDA INT,
	SOCTTOITHIEU INT,
	SOCTTOIDA INT,
	SOCTNUOCNGOAITOIDA INT,
);

CREATE TABLE BANGXEPHANG(
	MAXH INT,
	MATD INT,
	MADOI INT,
	TENDOI INT,
	THANG INT,
	HOA INT,
	THUA INT,
	HIEUSO INT,
	HANG INT,
);

CREATE TABLE GHINHAN
(
	TENMUA NVARCHAR(50),
	TENVONG NVARCHAR(50),
	TENCT NVARCHAR(50),
	LOAIBT NVARCHAR(20)
)

CREATE TABLE DANHSACHGHIBAN(
	MAGB INT PRIMARY KEY,
	MACT INT,
	TENCT NVARCHAR(50),
	MADOI INT,
	TENDOI NVARCHAR(50),
	LOAICT NVARCHAR(20),
	SOBANTHANG INT,
);

INSERT INTO DOIBONG VALUES(5,'FCB')

ALTER TABLE CAUTHU ADD LOAICAUTHU NVARCHAR(20)
ALTER TABLE CAUTHU ADD LOAICT NVARCHAR(50)
ALTER TABLE CAUTHU DROP COLUMN LOAICT

--select * from DOIBONG
SELECT D.TENDOI, S.TENSAN, S.SUCCHUA, S.DIACHI 
FROM DOIBONG D, SAN S, DOIBONG_MUAGIAI DM
WHERE D.MADOI = DM.MADOI AND DM.MASANNHA = S.MASAN 

DELETE FROM DOIBONG

--Đăng kí đội
INSERT INTO DOIBONG VALUES
(1, N'Becamex Bình Dương'),
(2, N'SHB Đà Nẵng'),
(3, N'Gạch Đồng Tâm Long An'),
(4, N'QNK Quảng Nam'),
(5, N'Đồng Tháp'),
(6, N'XSKT Cần Thơ'),
(7, N'Hoàng Anh Gia Lai'),
(8, N'Hà Nội T&T'),
(9, N'FLC Thanh Hóa');
INSERT INTO SAN VALUES
(1, N'Bình Dương', N'Dĩ An - Bình Dương', 10000),
(2, N'Sân thi đấu đà nẵng', N'Quận liên chiểu', 2500),
(3, N'Sân LA', N'tp Long An', 1000),
(4, N'Sân Quảng Nam', N'tp Quảng Nam', 10001),
(5, N'Sân Đồng Tháp', N'Cao Lãnh', 5200),
(6, N'Sân Cần Thơ', N'tp Cần Thơ', 2002),
(7, N'Sân Tây Nguyên', N'Đắc Lack', 50000),
(8, N'Sân Mĩ Đình', N'tp Hà Nội', 100000),
(9, N'Sân Thanh Hóa', N'Dân Choa 37', 10000);

SET DATEFORMAT DMY

INSERT INTO CAUTHU(MACT, TENCT, NGAYSINH, QUOCTICH, LOAICAUTHU) VALUES
(1, N'Nguyễn Tuấn Anh', '01-02-2003', N'Việt Nam', N'Tiền đạo'),
(2, N'Nguyễn Trường Thịnh', '06-09-2003', N'Việt Nam', N'Thủ môn'),
(3, N'Đoàn Nguyễn Trần Hoàn', '09-06-2003', N'Việt Nam', N'Tiền đạo'),
(4, N'Hà Trọng Tài', '03-12-2003', N'Việt Nam', N'Thủ môn'),
(5, N'Leonel Messi', '17-03-1999', N'Việt Nam', N'Hậu vệ'),
(6, N'Cris Ronaldo', '26-05-1997', N'Việt Nam', N'Tiền vệ'),
(7, N'Kylian Mbappe', '11-11-2000', N'Việt Nam', N'Tiền đạo'),
(8, N'Nguyễn Lê Messi', '05-06-2001', N'Việt Nam', N'Hậu vệ'),
(9, N'Đoàn Văn Vua', '06-09-2002', N'Việt Nam', N'Tiền vệ');

SELECT        DOIBONG.MADOI, DOIBONG.TENDOI, SAN.TENSAN, MUAGIAI.TENMUA
FROM            DOIBONG INNER JOIN
                         DOIBONG_MUAGIAI ON DOIBONG.MADOI = DOIBONG_MUAGIAI.MADOI INNER JOIN
                         SAN ON DOIBONG_MUAGIAI.MASANNHA = SAN.MASAN INNER JOIN
                         MUAGIAI ON DOIBONG_MUAGIAI.MAMUA = MUAGIAI.MAMUA
DELETE FROM MUAGIAI
ALTER TABLE MUAGIAI ALTER COLUMN TGBATDAU NVARCHAR(50)
ALTER TABLE MUAGIAI ALTER COLUMN TGKETTHUC NVARCHAR(50)
INSERT INTO MUAGIAI VALUES
(1, N'V-League 2015', 'Thursday , December 1, 2015', 'Friday, March 25, 2016'),
(2, N'V-League 2016', 'Wednesday , November 5, 2016', 'Sunday, February 14, 2017'),
(3, N'V-League 2017', 'Monday , August 16, 2017', 'Monday , January 28, 2018'),
(4, N'V-League 2018', 'Friday , May 19, 2018', 'Saturday , May 19, 2019'),
(5, N'V-League 2019', 'Monday , March 16, 2019', 'Tuesday , May 20, 2020'),
(6, N'V-League 2020', 'Monday , October 19, 2020', 'Wednesday, November 3 2021');

INSERT INTO DOIBONG_MUAGIAI VALUES
(1, 1, 1),
(2, 4, 4),
(3, 2, 2),
(4, 3, 3),
(5, 8, 8),
(6, 6, 6);

ALTER TABLE DANHSACHGHIBAN ALTER COLUMN MAGB INT NOT NULL
ALTER TABLE DANHSACHGHIBAN ADD CONSTRAINT PK_DSGB PRIMARY KEY (MAGB);

INSERT INTO DANHSACHGHIBAN VALUES
(1, 1, N'Nguyễn Tuấn Anh', 1, N'Becamex Bình Dương', N'Tiền đạo', 8),
(2, 8, N'Nguyễn Lê Messi', 8, N'Hà Nội T&T', N'Hậu vệ', 3),
(3, 9, N'Đoàn Văn Vua', 9, N'FLC Thanh Hóa', N'Tiền vệ', 5);

DELETE FROM DANHSACHGHIBAN

--INSERT INTO DANHSACHGHIBAN VALUES
--(1, 1, 'Nguyễn Tuấn Em', 1, 'Becamex Bình Dương', 'Tiền đạo', 8);

INSERT INTO BANTHANG VALUES
(1, 1, 1, 40),
(2, 1, 1, 60),
(3, 1, 1, 70),
(4, 1, 1, 80),
(5, 1, 1, 10),
(6, 1, 1, 20),
(7, 1, 1, 30),
(8, 1, 1, 44),
(9, 8, 8, 10),
(10, 8, 8, 20),
(11, 8, 8, 17),
(12, 9, 9, 6),
(13, 9, 9, 76),
(14, 9, 9, 16),
(15, 9, 9, 26),
(16, 9, 9, 36);

ALTER TABLE DOIBONG_CAUTHU DROP CONSTRAINT PK__DOIBONG___7B73B8681D542FDC
ALTER TABLE DOIBONG_CAUTHU ALTER COLUMN MAMUA INT NOT NULL
ALTER TABLE DOIBONG_CAUTHU ALTER COLUMN MADOI INT NOT NULL
ALTER TABLE DOIBONG_CAUTHU ALTER COLUMN MACT INT NOT NULL
ALTER TABLE DOIBONG_CAUTHU ADD CONSTRAINT PK_DBCT PRIMARY KEY (MAMUA, MADOI, MACT);


INSERT INTO DOIBONG_CAUTHU VALUES
(1, 1, 1, 5),
(2, 1, 1, 3),
(1, 8, 8, 1),
(3, 8, 8, 2),
(1, 9, 9, 1),
(3, 9, 9, 1),
(4, 9, 9, 1),
(5, 9, 9, 1),
(6, 9, 9, 1);

INSERT INTO VONGDAU VALUES
(1, N'Vòng 1', 1),
(2, N'Vòng 2', 1),
(3, N'Vòng cuối', 1),
(4, N'Vòng 1', 2),
(5, N'Vòng 2', 2),
(6, N'Vòng cuối', 2),
(7, N'Vòng 1', 3),
(8, N'Vòng 2', 3),
(9, N'Vòng cuối', 3),
(10, N'Vòng 1', 4),
(11, N'Vòng 2', 4),
(12, N'Vòng cuối', 4),
(13, N'Vòng 1', 5),
(14, N'Vòng 2', 5),
(15, N'Vòng cuối', 5),
(16, N'Vòng 1', 6),
(17, N'Vòng 2', 6),
(18, N'Vòng cuối', 6);

--THONG TIN DOI
SELECT D.TENDOI ,C.MACT, C.TENCT, C.LOAICAUTHU, C.NGAYSINH, C.QUOCTICH, M.TENMUA
FROM DOIBONG D, DOIBONG_CAUTHU DC, DOIBONG_MUAGIAI DM, MUAGIAI M, CAUTHU C
WHERE D.MADOI = DC.MADOI AND D.MADOI = DM.MADOI AND DM.MAMUA = M.MAMUA AND DC.MACT = C.MACT 

INSERT INTO QUYDINHCAUTHU VALUES
(1, 17, 40, 15, 22, 3)

INSERT INTO QUYDINHCAUTHU VALUES
(2, 18, 45, 15, 25, 4)

INSERT INTO QUYDINHBANTHANG VALUES
(1, 95, 3, 1, 0);

ALTER TABLE QUYDINHBANTHANG ADD CHECK(COUNT(MAQD) = 1)

INSERT INTO BANGXEPHANG VALUES
(1, 1, 1, 1, 3, 2, 1, 1, 1)

SELECT MAXH, MATD, MADOI, TENDOI, THANG, HOA, THUA, HIEUSO, HANG FROM BANGXEPHANG

SELECT * FROM DANHSACHGHIBAN WHERE TENDOI=N'Becamex Bình Dương'

ALTER TABLE DOIBONG_MUAGIAI DROP CONSTRAINT PK__DOIBONG___7B73B86877AF84E6
ALTER TABLE DOIBONG_MUAGIAI ALTER COLUMN MAMUA INT NOT NULL
ALTER TABLE DOIBONG_MUAGIAI ALTER COLUMN MADOI INT NOT NULL
ALTER TABLE DOIBONG_MUAGIAI ADD CONSTRAINT PK_DBMG PRIMARY KEY (MAMUA, MADOI);

SELECT MUAGIAI.TENMUA, DOIBONG.TENDOI, SAN.TENSAN 
FROM SAN JOIN DOIBONG ON SAN.MASAN = DOIBONG.MADOI
JOIN DOIBONG_MUAGIAI ON DOIBONG.MADOI = DOIBONG_MUAGIAI.MADOI
JOIN MUAGIAI ON DOIBONG_MUAGIAI.MAMUA = MUAGIAI.MAMUA

ALTER TABLE BANTHANG ADD LOAIBT CHAR(3)
ALTER TABLE BANTHANG ALTER COLUMN LOAIBT CHAR(20)
ALTER TABLE TRANDAU ADD MAMUA INT

select bt.mabt as 'Mã BT', bt.mact as 'Mã CT', bt.madoi as 'Mã DOI', bt.thoigian as 'THOI GIAN GHI BAN', bt.loaibt as 'LOAI BT'
from banthang bt

SELECT TD.MATD, (SELECT DB.TENDOI FROM DOIBONG DB WHERE DB.MADOI=TD.MADOI1) AS TENDOI1, (SELECT DB.TENDOI FROM DOIBONG DB WHERE DB.MADOI=TD.MADOI2) AS TENDOI2, TD.NGAYGIO, (SELECT S.TENSAN FROM SAN S WHERE S.MASAN=TD.MASAN) AS TENSAN, (SELECT VD.TENVONG FROM VONGDAU VD WHERE VD.MAVONG=TD.MAVONG) AS TENVONG, (SELECT MG.TENMUA FROM MUAGIAI MG WHERE MG.MAMUA=TD.MAMUA) AS TENMUA
FROM TRANDAU TD
SELECT DB.TENDOI FROM DOIBONG DB, TRANDAU TD WHERE DB.MADOI=TD.MADOI1
--SELECT 
--FROM TRANDAU JOIN DOIBONG
--==ON 

INSERT INTO TRANDAU VALUES
(
	@MATD,
	@
)

SELECT * FROM DOIBONG
SELECT MADOI FROM DOIBONG WHERE TENDOI =N'Becamex Bình Dương'

ALTER TABLE TRANDAU ALTER COLUMN NGAYGIO NVARCHAR(50)
ALTER TABLE TRANDAU ALTER COLUMN NGAYGIO SMALLDATETIME
DELETE FROM TRANDAU
ALTER TABLE TRANDAU DROP COLUMN MADOI1
ALTER TABLE TRANDAU DROP COLUMN MADOI2

ALTER TABLE TRANDAU ADD TENDOI1 NVARCHAR(50)
ALTER TABLE TRANDAU ADD TENDOI2 NVARCHAR(50)

ALTER TABLE TRANDAU DROP COLUMN MAVONG
ALTER TABLE TRANDAU DROP COLUMN MAMUA
ALTER TABLE TRANDAU DROP COLUMN MASAN

ALTER TABLE TRANDAU ADD TENVONG NVARCHAR(50)
ALTER TABLE TRANDAU ADD TENMUA NVARCHAR(50)
ALTER TABLE TRANDAU ADD TENSAN NVARCHAR(50)

DELETE FROM TRANDAU

--KETQUA ( MaKQ, MaTD, TENDOI1, TENDOI2, BTDoi1, BTDoi2, TENVONG, MUAGIAI, ThoiLuong)
CREATE TABLE KETQUA
(
	MAKQ INT PRIMARY KEY,
	MATD INT, 
	TENDOI1 NVARCHAR(50),
	TENDOI2 NVARCHAR(50),
	BTDOI1 INT,
	BTDOI2 INT,
	TENVONG NVARCHAR(50),
	TENMUA NVARCHAR(50),
	THOILUONG INT
)
SELECT * FROM KETQUA
DROP TABLE KETQUA


ALTER TABLE BANGXEPHANG ALTER COLUMN TENDOI NVARCHAR(50)
INSERT INTO BANGXEPHANG VALUES
(1, 1, 1, N'Becamex Bình Dương', 6, 0, 0, 15, 1),
(2, 2, 2, N'SHB Đà Nẵng', 5, 0, 1, 10, 2),
(3, 3, 4, N'QNK Quảng Nam', 4, 0, 2, 8, 3),
(4, 4, 5, N'Đồng Tháp', 3, 0, 3, 5, 4),
(5, 5, 7, N'Hoàng Anh Gia Lai', 2, 0, 4, -5, 5);

DELETE FROM BANGXEPHANG
CREATE TABLE LOAICT(
	MALOAICT INT,
	TENLOAICT NVARCHAR(20),
);
DELETE FROM LOAICT
INSERT INTO LOAICT VALUES
(1, N'Loại A'),
(2, N'Loại B'),
(3, N'Loại C'),
(4, N'Loại D');

INSERT INTO DOIBONG_CAUTHU VALUES
(1, 1, 2, 1),
(1, 1, 5, 2);

SELECT MUAGIAI.TENMUA, DOIBONG.TENDOI, CAUTHU.TENCT, CAUTHU.QUOCTICH, CAUTHU.LOAICAUTHU
FROM CAUTHU JOIN DOIBONG_CAUTHU ON CAUTHU.MACT = DOIBONG_CAUTHU.MACT
JOIN DOIBONG ON DOIBONG.MADOI = DOIBONG_CAUTHU.MADOI
JOIN MUAGIAI ON MUAGIAI.MAMUA = DOIBONG_CAUTHU.MAMUA